<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.3 Simulating predictors at different hierarchical levels | The {squidSim} R Package Vignette   Version 0.2.0</title>
  <meta name="description" content="This is a vignette for using the squidSim R package." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="2.3 Simulating predictors at different hierarchical levels | The {squidSim} R Package Vignette   Version 0.2.0" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a vignette for using the squidSim R package." />
  <meta name="github-repo" content="squidgroup/squidSim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.3 Simulating predictors at different hierarchical levels | The {squidSim} R Package Vignette   Version 0.2.0" />
  
  <meta name="twitter:description" content="This is a vignette for using the squidSim R package." />
  

<meta name="author" content="Joel Pick" />


<meta name="date" content="2025-09-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="2.2-factors.html"/>
<link rel="next" href="2.4-randomslopes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The {squidSim} R package</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-use-squidsim"><i class="fa fa-check"></i>Why use {squidSim}?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-the-vignette"><i class="fa fa-check"></i>Using the vignette</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-squidsim"><i class="fa fa-check"></i>Citing {squidSim}</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-bugs"><i class="fa fa-check"></i>Issues and bugs</a></li>
<li class="chapter" data-level="" data-path="simulate_population-function.html"><a href="simulate_population-function.html"><i class="fa fa-check"></i><code>simulate_population()</code> function</a></li>
<li class="chapter" data-level="" data-path="terminology-and-notation.html"><a href="terminology-and-notation.html"><i class="fa fa-check"></i>Terminology and notation</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html"><i class="fa fa-check"></i>Mathematical Notation</a>
<ul>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#general-rules"><i class="fa fa-check"></i>General rules</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#notation-for-a-linear-mixed-model"><i class="fa fa-check"></i>Notation for a linear mixed model</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#distributions"><i class="fa fa-check"></i>Distributions</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#interactions-random-regression"><i class="fa fa-check"></i>Interactions / Random regression</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#multi-response"><i class="fa fa-check"></i>Multi-response</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-linearmod.html"><a href="1-linearmod.html"><i class="fa fa-check"></i><b>1</b> Simulating from linear models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-simple-linear-model.html"><a href="1.1-simple-linear-model.html"><i class="fa fa-check"></i><b>1.1</b> Simple Linear Model</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1.1-simple-linear-model.html"><a href="1.1-simple-linear-model.html#adding-more-information-about-the-predictors"><i class="fa fa-check"></i><b>1.1.1</b> Adding more information about the predictors</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1.2-corpred.html"><a href="1.2-corpred.html"><i class="fa fa-check"></i><b>1.2</b> Correlated predictors</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-interactions.html"><a href="1.3-interactions.html"><i class="fa fa-check"></i><b>1.3</b> Interactions and non-linear effects</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-interactions.html"><a href="1.3-interactions.html#interactions-1"><i class="fa fa-check"></i><b>1.3.1</b> Interactions</a></li>
<li class="chapter" data-level="1.3.2" data-path="1.3-interactions.html"><a href="1.3-interactions.html#non-linear-effects"><i class="fa fa-check"></i><b>1.3.2</b> Non-linear effects</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-transformations.html"><a href="1.4-transformations.html"><i class="fa fa-check"></i><b>1.4</b> Transformations</a></li>
<li class="chapter" data-level="1.5" data-path="1.5-knownpreds.html"><a href="1.5-knownpreds.html"><i class="fa fa-check"></i><b>1.5</b> Known Predictors</a></li>
<li class="chapter" data-level="1.6" data-path="1.6-nonGaussian.html"><a href="1.6-nonGaussian.html"><i class="fa fa-check"></i><b>1.6</b> Non-Gaussian phenotypes</a></li>
<li class="chapter" data-level="1.7" data-path="1.7-modeleq.html"><a href="1.7-modeleq.html"><i class="fa fa-check"></i><b>1.7</b> Model equations</a></li>
<li class="chapter" data-level="1.8" data-path="1.8-npop.html"><a href="1.8-npop.html"><i class="fa fa-check"></i><b>1.8</b> Simulating multiple populations</a></li>
<li class="chapter" data-level="1.9" data-path="1.9-parameter-list-summary.html"><a href="1.9-parameter-list-summary.html"><i class="fa fa-check"></i><b>1.9</b> Parameter list summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-hierarchical.html"><a href="2-hierarchical.html"><i class="fa fa-check"></i><b>2</b> Hierarchical structure</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html"><i class="fa fa-check"></i><b>2.1</b> Making a hierarchical structure</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html#single-factor"><i class="fa fa-check"></i><b>2.1.1</b> Single Factor</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-makestr.html"><a href="2.1-makestr.html#nested-factors"><i class="fa fa-check"></i><b>2.1.2</b> Nested factors</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-makestr.html"><a href="2.1-makestr.html#crossed-factors"><i class="fa fa-check"></i><b>2.1.3</b> Crossed factors</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-makestr.html"><a href="2.1-makestr.html#temporal-structure"><i class="fa fa-check"></i><b>2.1.4</b> Temporal structure</a></li>
<li class="chapter" data-level="2.1.5" data-path="2.1-makestr.html"><a href="2.1-makestr.html#naming-factor-levels"><i class="fa fa-check"></i><b>2.1.5</b> Naming factor levels</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-factors.html"><a href="2.2-factors.html"><i class="fa fa-check"></i><b>2.2</b> Factors</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="2.2-factors.html"><a href="2.2-factors.html#fixed-factor-interactions"><i class="fa fa-check"></i><b>2.2.1</b> Fixed Factor Interactions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html"><i class="fa fa-check"></i><b>2.3</b> Simulating predictors at different hierarchical levels</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#simulating-random-effects"><i class="fa fa-check"></i><b>2.3.1</b> Simulating ‘random’ effects</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#incorporating-existing-data-structures"><i class="fa fa-check"></i><b>2.3.2</b> Incorporating existing data structures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-randomslopes.html"><a href="2.4-randomslopes.html"><i class="fa fa-check"></i><b>2.4</b> Random Regression</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-BetweenWithin.html"><a href="2.5-BetweenWithin.html"><i class="fa fa-check"></i><b>2.5</b> Among- and within-group effects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-multivariate.html"><a href="3-multivariate.html"><i class="fa fa-check"></i><b>3</b> Multi-response Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-predictors-affecting-multiple-responses.html"><a href="3.1-predictors-affecting-multiple-responses.html"><i class="fa fa-check"></i><b>3.1</b> Predictors affecting multiple responses</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-one-response-repeatedly-measured-the-other-not.html"><a href="3.2-one-response-repeatedly-measured-the-other-not.html"><i class="fa fa-check"></i><b>3.2</b> One response repeatedly measured, the other not</a></li>
<li class="chapter" data-level="3.3" data-path="3.3-different-distributions.html"><a href="3.3-different-distributions.html"><i class="fa fa-check"></i><b>3.3</b> Different distributions</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-multivariate-random-slopes.html"><a href="3.4-multivariate-random-slopes.html"><i class="fa fa-check"></i><b>3.4</b> Multivariate Random Slopes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-animal.html"><a href="4-animal.html"><i class="fa fa-check"></i><b>4</b> Genetic effects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-va.html"><a href="4.1-va.html"><i class="fa fa-check"></i><b>4.1</b> Additive genetics effects</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-multivariate-genetic-effects.html"><a href="4.2-multivariate-genetic-effects.html"><i class="fa fa-check"></i><b>4.2</b> Multivariate genetic effects</a></li>
<li class="chapter" data-level="4.3" data-path="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><a href="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><i class="fa fa-check"></i><b>4.3</b> Sex specific genetic variance and inter-sexual genetic correlations</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-IGE.html"><a href="4.4-IGE.html"><i class="fa fa-check"></i><b>4.4</b> Indirect Genetic Effects</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-gxe.html"><a href="4.5-gxe.html"><i class="fa fa-check"></i><b>4.5</b> GxE</a></li>
<li class="chapter" data-level="4.6" data-path="4.6-dominance.html"><a href="4.6-dominance.html"><i class="fa fa-check"></i><b>4.6</b> Dominance</a></li>
<li class="chapter" data-level="4.7" data-path="4.7-inbreeding-depression.html"><a href="4.7-inbreeding-depression.html"><i class="fa fa-check"></i><b>4.7</b> Inbreeding depression</a></li>
<li class="chapter" data-level="4.8" data-path="4.8-genetic-groups.html"><a href="4.8-genetic-groups.html"><i class="fa fa-check"></i><b>4.8</b> Genetic Groups</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-phylogenetic.html"><a href="5-phylogenetic.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic Effects</a></li>
<li class="chapter" data-level="6" data-path="6-temporal-and-spatial-effects.html"><a href="6-temporal-and-spatial-effects.html"><i class="fa fa-check"></i><b>6</b> Temporal and Spatial Effects</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-simple-temporal-effects.html"><a href="6.1-simple-temporal-effects.html"><i class="fa fa-check"></i><b>6.1</b> Simple Temporal Effects</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-cyclical-temporal-effects.html"><a href="6.2-cyclical-temporal-effects.html"><i class="fa fa-check"></i><b>6.2</b> Cyclical Temporal Effects</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-temporalauto.html"><a href="6.3-temporalauto.html"><i class="fa fa-check"></i><b>6.3</b> Temporal Autocorrelation</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-spatialauto.html"><a href="6.4-spatialauto.html"><i class="fa fa-check"></i><b>6.4</b> Spatial Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-sampling.html"><a href="7-sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-nested.html"><a href="7.1-nested.html"><i class="fa fa-check"></i><b>7.1</b> Nested</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-nested.html"><a href="7.1-nested.html#worked-example-1"><i class="fa fa-check"></i><b>7.1.1</b> Worked example 1</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html"><i class="fa fa-check"></i><b>7.2</b> Missing data</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mcar"><i class="fa fa-check"></i><b>7.2.1</b> MCAR</a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mar"><i class="fa fa-check"></i><b>7.2.2</b> MAR</a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mnar"><i class="fa fa-check"></i><b>7.2.3</b> MNAR</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-temporal-sampling.html"><a href="7.3-temporal-sampling.html"><i class="fa fa-check"></i><b>7.3</b> Temporal Sampling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-other-model-types.html"><a href="8-other-model-types.html"><i class="fa fa-check"></i><b>8</b> Other model Types</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html"><i class="fa fa-check"></i><b>8.1</b> Double hierarchical models (DHGLMs)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html#dhglm"><i class="fa fa-check"></i><b>8.1.1</b> DHGLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html#bivariate-dhglm"><i class="fa fa-check"></i><b>8.1.2</b> Bivariate DHGLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-zero-inflated-poisson.html"><a href="8.2-zero-inflated-poisson.html"><i class="fa fa-check"></i><b>8.2</b> Zero-inflated Poisson</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The {squidSim} R Package Vignette <br> Version 0.2.0</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulating-predictors-at-different-hierarchical-levels" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Simulating predictors at different hierarchical levels<a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#simulating-predictors-at-different-hierarchical-levels" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!-- <div class="panel panel-success">
<div class="panel-heading">
**Biological example**
</div>
<div class="panel-body">
We have taken repeated measurements of adult body mass.  
</div>
</div> -->
<p>As well as simulating continuous predictors at the level of the observation, we can also simulate predictors at different hierarchical levels. Let’s take the example of a situation where we have repeated measures of individuals. The individuals have traits that are consistently expressed, whilst the environment varies between observations. We can describe variation at these different hierarchical levels as:</p>
<p><span class="math display">\[
y_{ij} = \beta_0 + \boldsymbol{x}_{i} \boldsymbol{\beta}_x + \boldsymbol{u}_j \boldsymbol{\beta}_u + \epsilon_{ij}
\]</span>
<span class="math display">\[
\boldsymbol{x}_i \sim \mathcal{N}(\boldsymbol{\mu}_x, \Sigma_x)
\]</span>
<span class="math display">\[
\boldsymbol{u}_j \sim \mathcal{N}(\boldsymbol{\mu}_u, \Sigma_u)
\]</span>
<span class="math display">\[
\epsilon_i \sim \mathcal{N}(0,\sigma^2_\epsilon)
\]</span></p>
<p>where <span class="math inline">\(U\)</span> is a matrix of predictors that vary at the individual level (denoted by the subscript <span class="math inline">\(j\)</span>), and <span class="math inline">\(X\)</span> is a matrix of predictors at the observation level (denoted by the index <span class="math inline">\(i\)</span>).</p>
<p>In order to simulate from this model, we need a data structure and parameters for each of these levels. To do this, we can either specify a data structure generated using <code>make_structure</code> (outlined previously in Section <a href="2.1-makestr.html#makestr">2.1</a>), or a pre-existing data structure, to the <code>simulate_population</code> function. We then add an item to the parameter list, the name of which matches on of the grouping factors in the data structure, and specify the parameters for predictors that vary at that level in the same way as outlined in the previous section (<a href="1-linearmod.html#linearmod">1</a>). This is similar to the fixed factors above, but we are now assuming that the variable is drawn randomly from a distribution, rather than the effects at each level being fixed.</p>
<p>Lets imagine that we simulate behaviour, that is a functions of an individual’s size and physiology, and also varies in response to the environment, here temperature and rainfall:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb124-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> <span class="fu">make_structure</span>(<span class="at">structure =</span> <span class="st">&quot;individual(500)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">2</span>),</span>
<span id="cb124-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb124-4"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">individual =</span> <span class="fu">list</span>(</span>
<span id="cb124-5"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>,<span class="st">&quot;physiology&quot;</span>),</span>
<span id="cb124-6"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>)</span>
<span id="cb124-7"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb124-8"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation =</span> <span class="fu">list</span>(</span>
<span id="cb124-9"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;temperature&quot;</span>,<span class="st">&quot;rainfall&quot;</span>),</span>
<span id="cb124-10"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb124-11"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb124-12"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb124-13"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb124-14"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb124-15"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb124-16"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">response_names=</span><span class="st">&quot;behaviour&quot;</span></span>
<span id="cb124-17"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb124-18"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-19"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-19" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb124-20"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-21"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(behaviour <span class="sc">~</span> size <span class="sc">+</span> physiology <span class="sc">+</span> temperature <span class="sc">+</span> rainfall , data))</span></code></pre></div>
<pre><code>## (Intercept)        size  physiology temperature    rainfall 
## -0.03402370  0.07313193  0.17416616  0.24872731 -0.11561841</code></pre>
<p>Here, we have simulated 4 predictors, ‘size’ and ‘physiology’ that vary at the level of the individual, and ‘temperature’ and ‘rainfall’ that vary at the level of the observation. To keep things simple, we will simulate them all as unit normal variables (mean=0 and variance=1). Note, <strong>the names of the different grouping factors in the parameter list (here ‘individual’) needs to exactly match those in the data structure</strong>. The order does not, however, have to be the same. There are circumstances in which we may want to simulate two sets of effects at the same hierarchical level (for example see permanent environment effects in Section <a href="4.1-va.html#va">4.1</a>), in this case we can call them different things in the parameter list, but link them back to the grouping factor, by providing a <code>group</code> name. For example the following will produce the same simulation as above:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb126-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> <span class="fu">make_structure</span>(<span class="at">structure =</span> <span class="st">&quot;individual(500)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">2</span>),</span>
<span id="cb126-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb126-4"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ind1 =</span> <span class="fu">list</span>(</span>
<span id="cb126-5"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span><span class="st">&quot;individual&quot;</span>,</span>
<span id="cb126-6"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;size&quot;</span>),</span>
<span id="cb126-7"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.1</span>)</span>
<span id="cb126-8"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-9"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ind2 =</span> <span class="fu">list</span>(</span>
<span id="cb126-10"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">group=</span><span class="st">&quot;individual&quot;</span>,</span>
<span id="cb126-11"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">names =</span> <span class="fu">c</span>(<span class="st">&quot;physiology&quot;</span>),</span>
<span id="cb126-12"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.2</span>)</span>
<span id="cb126-13"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-14"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">observation =</span> <span class="fu">list</span>(</span>
<span id="cb126-15"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">names=</span><span class="fu">c</span>(<span class="st">&quot;temperature&quot;</span>,<span class="st">&quot;rainfall&quot;</span>),</span>
<span id="cb126-16"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="sc">-</span><span class="fl">0.1</span>)</span>
<span id="cb126-17"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-17" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb126-18"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb126-19"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb126-20"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb126-21"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-21" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb126-22"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">response_names=</span><span class="st">&quot;behaviour&quot;</span></span>
<span id="cb126-23"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb126-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>It is also worth noting that predictors do not have to be simulated for every grouping factor in the data structure - in this way no variation at that level can be simulated.</p>
<div id="simulating-random-effects" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Simulating ‘random’ effects<a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#simulating-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In essence, random effects (random intercepts) represent an unobserved/latent predictor (or group of predictors), which varies at a given hierarchical level. In a mixed effect model, the effect at each level of the grouping factor is unknown, and estimated by the model (and assumed to come from a normal distribution). When simulating this, however, we can simply simulate an additional predictor at a particular hierarchical level (<span class="math inline">\(z\)</span>) with mean 0 and a given variance (<span class="math inline">\(\sigma^2_z\)</span>).</p>
<p><span class="math display">\[
y_{ij} = \beta_0 + u_j + \epsilon_{ij}
\]</span>
<span class="math display">\[
u_j \sim \mathcal{N}(0,\sigma^2_u)
\]</span>
<span class="math display">\[
\epsilon_i \sim \mathcal{N}(0,\sigma^2_\epsilon)
\]</span></p>
<p>For example, we can simulate some among-individual variation as follows:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb127-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> <span class="fu">make_structure</span>(<span class="at">structure =</span> <span class="st">&quot;individual(500)&quot;</span>, <span class="at">repeat_obs=</span><span class="dv">2</span>),</span>
<span id="cb127-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb127-4"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">individual =</span> <span class="fu">list</span>(</span>
<span id="cb127-5"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb127-6"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb127-7"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb127-8"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb127-9"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb127-10"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb127-11"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb127-12"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-13" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb127-14"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##              y individual_effect   residual individual squid_pop
## 1  0.602356146         0.1594673  0.4428889          1         1
## 2  1.204485552         0.1594673  1.0450183          1         1
## 3 -0.681867088        -0.3816181 -0.3002490          2         1
## 4 -1.436016418        -0.3816181 -1.0543983          2         1
## 5  0.006081218         0.7306521 -0.7245709          3         1
## 6  0.177797638         0.7306521 -0.5528544          3         1</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb129-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb129-2" aria-hidden="true" tabindex="-1"></a>short_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">print</span>(<span class="fu">summary</span>(x), <span class="at">correlation=</span><span class="cn">FALSE</span>, <span class="at">show.resids=</span><span class="cn">FALSE</span>, <span class="at">ranef.comp =</span> <span class="fu">c</span>(<span class="st">&quot;Variance&quot;</span>))</span>
<span id="cb129-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="fu">short_summary</span>(<span class="fu">lmer</span>(y <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>individual), data))</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ 1 + (1 | individual)
##    Data: data
## 
## REML criterion at convergence: 2694
## 
## Random effects:
##  Groups     Name        Variance
##  individual (Intercept) 0.4741  
##  Residual               0.5103  
## Number of obs: 1000, groups:  individual, 500
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  0.03428    0.03819   0.898</code></pre>
<p>Note that here we haven’t specified any variable names. In this case the simulated predictors are named by the grouping factors (e.g. individual_effect).</p>
</div>
<div id="incorporating-existing-data-structures" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Incorporating existing data structures<a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#incorporating-existing-data-structures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We could also use an existing data structure, taking the grouping factors and levels from an existing dataset and input them to <code>simulate_population</code>. To demonstrate this, we can use the <a href="https://rdrr.io/cran/MCMCglmm/man/BTdata.html">blue tit dataset</a> provided with the MCMCglmm package. This is a dataset with some continuous variables (tarsus, back (coloration) and hatchdate), and some grouping factors (animal, dam, fosternest and sex), the latter providing a data structure from which to simulate.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCglmm)</span>
<span id="cb131-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(BTdata)</span>
<span id="cb131-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(BTdata)</span></code></pre></div>
<pre><code>##        tarsus       back  animal     dam fosternest  hatchdate  sex
## 1 -1.89229718  1.1464212 R187142 R187557      F2102 -0.6874021  Fem
## 2  1.13610981 -0.7596521 R187154 R187559      F1902 -0.6874021 Male
## 3  0.98468946  0.1449373 R187341 R187568       A602 -0.4279814 Male
## 4  0.37900806  0.2555847 R046169 R187518      A1302 -1.4656641 Male
## 5 -0.07525299 -0.3006992 R046161 R187528      A2602 -1.4656641  Fem
## 6 -1.13519543  1.5577219 R187409 R187945      C2302  0.3502805  Fem</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb133-2"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> BTdata[,<span class="fu">c</span>(<span class="st">&quot;dam&quot;</span>,<span class="st">&quot;fosternest&quot;</span>)],</span>
<span id="cb133-3"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb133-4"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dam =</span> <span class="fu">list</span>(</span>
<span id="cb133-5"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.2</span></span>
<span id="cb133-6"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-6" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb133-7"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fosternest =</span> <span class="fu">list</span>(</span>
<span id="cb133-8"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.3</span></span>
<span id="cb133-9"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb133-10"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb133-11"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb133-12"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb133-13"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb133-14"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb133-15"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-16"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-16" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb133-17"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#cb133-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##            y    dam_effect fosternest_effect    residual     dam fosternest
## 1  0.3414224  0.0004465141        0.26993761  0.07103831 R187557      F2102
## 2  0.4892094  0.0512931487       -0.13437510  0.57229137 R187559      F1902
## 3  1.6103895  0.0428057278        0.69045892  0.87712480 R187568       A602
## 4 -1.3354583 -0.2351044549       -0.61425069 -0.48610310 R187518      A1302
## 5 -0.1467267  0.9155448975       -0.44713888 -0.61513276 R187528      A2602
## 6  1.3456794  0.5799862495        0.02555989  0.74013326 R187945      C2302
##   squid_pop
## 1         1
## 2         1
## 3         1
## 4         1
## 5         1
## 6         1</code></pre>
<!-- getME(mod,"theta")
library(numDeriv)
fm1Fun <- update(mod,devFunOnly=TRUE)
fm1_thpar <- getME(mod,"theta")
h <- hessian(fm1Fun, fm1_thpar)
sqrt(diag(solve(h)))

mySumm2 <- function(.) {
    c(beta=fixef(.),sigma=sigma(.), sig01=unlist(VarCorr(.)))
}
bootMer(mod,mySumm2,nsim = 100) -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="2.2-factors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="2.4-randomslopes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

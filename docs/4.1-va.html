<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.1 Additive genetics effects | The {squidSim} R Package Vignette   Version 0.2.2</title>
  <meta name="description" content="This is a vignette for using the squidSim R package." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="4.1 Additive genetics effects | The {squidSim} R Package Vignette   Version 0.2.2" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a vignette for using the squidSim R package." />
  <meta name="github-repo" content="squidgroup/squidSim" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.1 Additive genetics effects | The {squidSim} R Package Vignette   Version 0.2.2" />
  
  <meta name="twitter:description" content="This is a vignette for using the squidSim R package." />
  

<meta name="author" content="Joel Pick" />


<meta name="date" content="2025-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="4-animal.html"/>
<link rel="next" href="4.2-multivariate-genetic-effects.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>The {squidSim} R package</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#why-use-squidsim"><i class="fa fa-check"></i>Why use {squidSim}?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#using-the-vignette"><i class="fa fa-check"></i>Using the vignette</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#citing-squidsim"><i class="fa fa-check"></i>Citing {squidSim}</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#issues-and-bugs"><i class="fa fa-check"></i>Issues and bugs</a></li>
<li class="chapter" data-level="" data-path="simulate_population-function.html"><a href="simulate_population-function.html"><i class="fa fa-check"></i><code>simulate_population()</code> function</a></li>
<li class="chapter" data-level="" data-path="terminology-and-notation.html"><a href="terminology-and-notation.html"><i class="fa fa-check"></i>Terminology and notation</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html"><i class="fa fa-check"></i>Mathematical Notation</a>
<ul>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#general-rules"><i class="fa fa-check"></i>General rules</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#notation-for-a-linear-mixed-model"><i class="fa fa-check"></i>Notation for a linear mixed model</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#distributions"><i class="fa fa-check"></i>Distributions</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#interactions-random-regression"><i class="fa fa-check"></i>Interactions / Random regression</a></li>
<li class="chapter" data-level="" data-path="mathematical-notation.html"><a href="mathematical-notation.html#multi-response"><i class="fa fa-check"></i>Multi-response</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="1-linearmod.html"><a href="1-linearmod.html"><i class="fa fa-check"></i><b>1</b> Simulating from linear models</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1.1-simple-linear-model.html"><a href="1.1-simple-linear-model.html"><i class="fa fa-check"></i><b>1.1</b> Simple Linear Model</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1.1-simple-linear-model.html"><a href="1.1-simple-linear-model.html#adding-more-information-about-the-predictors"><i class="fa fa-check"></i><b>1.1.1</b> Adding more information about the predictors</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1.2-corpred.html"><a href="1.2-corpred.html"><i class="fa fa-check"></i><b>1.2</b> Correlated predictors</a></li>
<li class="chapter" data-level="1.3" data-path="1.3-interactions.html"><a href="1.3-interactions.html"><i class="fa fa-check"></i><b>1.3</b> Interactions and non-linear effects</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="1.3-interactions.html"><a href="1.3-interactions.html#interactions-1"><i class="fa fa-check"></i><b>1.3.1</b> Interactions</a></li>
<li class="chapter" data-level="1.3.2" data-path="1.3-interactions.html"><a href="1.3-interactions.html#non-linear-effects"><i class="fa fa-check"></i><b>1.3.2</b> Non-linear effects</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="1.4-transformations.html"><a href="1.4-transformations.html"><i class="fa fa-check"></i><b>1.4</b> Transformations</a></li>
<li class="chapter" data-level="1.5" data-path="1.5-knownpreds.html"><a href="1.5-knownpreds.html"><i class="fa fa-check"></i><b>1.5</b> Known Predictors</a></li>
<li class="chapter" data-level="1.6" data-path="1.6-nonGaussian.html"><a href="1.6-nonGaussian.html"><i class="fa fa-check"></i><b>1.6</b> Non-Gaussian phenotypes</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="1.6-nonGaussian.html"><a href="1.6-nonGaussian.html#transforming-across-scales"><i class="fa fa-check"></i><b>1.6.1</b> Transforming across scales</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="1.7-modeleq.html"><a href="1.7-modeleq.html"><i class="fa fa-check"></i><b>1.7</b> Model equations</a></li>
<li class="chapter" data-level="1.8" data-path="1.8-npop.html"><a href="1.8-npop.html"><i class="fa fa-check"></i><b>1.8</b> Simulating multiple populations</a></li>
<li class="chapter" data-level="1.9" data-path="1.9-parameter-list-summary.html"><a href="1.9-parameter-list-summary.html"><i class="fa fa-check"></i><b>1.9</b> Parameter list summary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-hierarchical.html"><a href="2-hierarchical.html"><i class="fa fa-check"></i><b>2</b> Hierarchical structure</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html"><i class="fa fa-check"></i><b>2.1</b> Making a hierarchical structure</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2.1-makestr.html"><a href="2.1-makestr.html#single-factor"><i class="fa fa-check"></i><b>2.1.1</b> Single Factor</a></li>
<li class="chapter" data-level="2.1.2" data-path="2.1-makestr.html"><a href="2.1-makestr.html#nested-factors"><i class="fa fa-check"></i><b>2.1.2</b> Nested factors</a></li>
<li class="chapter" data-level="2.1.3" data-path="2.1-makestr.html"><a href="2.1-makestr.html#crossed-factors"><i class="fa fa-check"></i><b>2.1.3</b> Crossed factors</a></li>
<li class="chapter" data-level="2.1.4" data-path="2.1-makestr.html"><a href="2.1-makestr.html#temporal-structure"><i class="fa fa-check"></i><b>2.1.4</b> Temporal structure</a></li>
<li class="chapter" data-level="2.1.5" data-path="2.1-makestr.html"><a href="2.1-makestr.html#naming-factor-levels"><i class="fa fa-check"></i><b>2.1.5</b> Naming factor levels</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2.2-factors.html"><a href="2.2-factors.html"><i class="fa fa-check"></i><b>2.2</b> Factors</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="2.2-factors.html"><a href="2.2-factors.html#fixed-factor-interactions"><i class="fa fa-check"></i><b>2.2.1</b> Fixed Factor Interactions</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html"><i class="fa fa-check"></i><b>2.3</b> Simulating predictors at different hierarchical levels</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#simulating-random-effects"><i class="fa fa-check"></i><b>2.3.1</b> Simulating ‘random’ effects</a></li>
<li class="chapter" data-level="2.3.2" data-path="2.3-simulating-predictors-at-different-hierarchical-levels.html"><a href="2.3-simulating-predictors-at-different-hierarchical-levels.html#incorporating-existing-data-structures"><i class="fa fa-check"></i><b>2.3.2</b> Incorporating existing data structures</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2.4-randomslopes.html"><a href="2.4-randomslopes.html"><i class="fa fa-check"></i><b>2.4</b> Random Regression</a></li>
<li class="chapter" data-level="2.5" data-path="2.5-BetweenWithin.html"><a href="2.5-BetweenWithin.html"><i class="fa fa-check"></i><b>2.5</b> Among- and within-group effects</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-multivariate.html"><a href="3-multivariate.html"><i class="fa fa-check"></i><b>3</b> Multi-response Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3.1-predictors-affecting-multiple-responses.html"><a href="3.1-predictors-affecting-multiple-responses.html"><i class="fa fa-check"></i><b>3.1</b> Predictors affecting multiple responses</a></li>
<li class="chapter" data-level="3.2" data-path="3.2-one-response-repeatedly-measured-the-other-not.html"><a href="3.2-one-response-repeatedly-measured-the-other-not.html"><i class="fa fa-check"></i><b>3.2</b> One response repeatedly measured, the other not</a></li>
<li class="chapter" data-level="3.3" data-path="3.3-different-distributions.html"><a href="3.3-different-distributions.html"><i class="fa fa-check"></i><b>3.3</b> Different distributions</a></li>
<li class="chapter" data-level="3.4" data-path="3.4-multivariate-random-slopes.html"><a href="3.4-multivariate-random-slopes.html"><i class="fa fa-check"></i><b>3.4</b> Multivariate Random Slopes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-animal.html"><a href="4-animal.html"><i class="fa fa-check"></i><b>4</b> Genetic effects</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4.1-va.html"><a href="4.1-va.html"><i class="fa fa-check"></i><b>4.1</b> Additive genetics effects</a></li>
<li class="chapter" data-level="4.2" data-path="4.2-multivariate-genetic-effects.html"><a href="4.2-multivariate-genetic-effects.html"><i class="fa fa-check"></i><b>4.2</b> Multivariate genetic effects</a></li>
<li class="chapter" data-level="4.3" data-path="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><a href="4.3-sex-specific-genetic-variance-and-inter-sexual-genetic-correlations.html"><i class="fa fa-check"></i><b>4.3</b> Sex specific genetic variance and inter-sexual genetic correlations</a></li>
<li class="chapter" data-level="4.4" data-path="4.4-IGE.html"><a href="4.4-IGE.html"><i class="fa fa-check"></i><b>4.4</b> Indirect Genetic Effects</a></li>
<li class="chapter" data-level="4.5" data-path="4.5-gxe.html"><a href="4.5-gxe.html"><i class="fa fa-check"></i><b>4.5</b> GxE</a></li>
<li class="chapter" data-level="4.6" data-path="4.6-dominance.html"><a href="4.6-dominance.html"><i class="fa fa-check"></i><b>4.6</b> Dominance</a></li>
<li class="chapter" data-level="4.7" data-path="4.7-inbreeding-depression.html"><a href="4.7-inbreeding-depression.html"><i class="fa fa-check"></i><b>4.7</b> Inbreeding depression</a></li>
<li class="chapter" data-level="4.8" data-path="4.8-genetic-groups.html"><a href="4.8-genetic-groups.html"><i class="fa fa-check"></i><b>4.8</b> Genetic Groups</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-phylogenetic.html"><a href="5-phylogenetic.html"><i class="fa fa-check"></i><b>5</b> Phylogenetic Effects</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5.1-brownian-motion.html"><a href="5.1-brownian-motion.html"><i class="fa fa-check"></i><b>5.1</b> Brownian motion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-temporal-and-spatial-effects.html"><a href="6-temporal-and-spatial-effects.html"><i class="fa fa-check"></i><b>6</b> Temporal and Spatial Effects</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6.1-simple-temporal-effects.html"><a href="6.1-simple-temporal-effects.html"><i class="fa fa-check"></i><b>6.1</b> Simple Temporal Effects</a></li>
<li class="chapter" data-level="6.2" data-path="6.2-cyclical-temporal-effects.html"><a href="6.2-cyclical-temporal-effects.html"><i class="fa fa-check"></i><b>6.2</b> Cyclical Temporal Effects</a></li>
<li class="chapter" data-level="6.3" data-path="6.3-temporalauto.html"><a href="6.3-temporalauto.html"><i class="fa fa-check"></i><b>6.3</b> Temporal Autocorrelation</a></li>
<li class="chapter" data-level="6.4" data-path="6.4-spatialauto.html"><a href="6.4-spatialauto.html"><i class="fa fa-check"></i><b>6.4</b> Spatial Autocorrelation</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="6.4-spatialauto.html"><a href="6.4-spatialauto.html#example-species-occurrence-data-with-spatial-autocorrelation"><i class="fa fa-check"></i><b>6.4.1</b> Example: Species occurrence data with spatial autocorrelation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-sampling.html"><a href="7-sampling.html"><i class="fa fa-check"></i><b>7</b> Sampling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7.1-nested.html"><a href="7.1-nested.html"><i class="fa fa-check"></i><b>7.1</b> Nested</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="7.1-nested.html"><a href="7.1-nested.html#worked-example-1"><i class="fa fa-check"></i><b>7.1.1</b> Worked example 1</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html"><i class="fa fa-check"></i><b>7.2</b> Missing data</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mcar"><i class="fa fa-check"></i><b>7.2.1</b> MCAR</a></li>
<li class="chapter" data-level="7.2.2" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mar"><i class="fa fa-check"></i><b>7.2.2</b> MAR</a></li>
<li class="chapter" data-level="7.2.3" data-path="7.2-missing-data.html"><a href="7.2-missing-data.html#mnar"><i class="fa fa-check"></i><b>7.2.3</b> MNAR</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="7.3-temporal-sampling.html"><a href="7.3-temporal-sampling.html"><i class="fa fa-check"></i><b>7.3</b> Temporal Sampling</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-other-model-types.html"><a href="8-other-model-types.html"><i class="fa fa-check"></i><b>8</b> Other model Types</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html"><i class="fa fa-check"></i><b>8.1</b> Double hierarchical models (DHGLMs)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html#dhglm"><i class="fa fa-check"></i><b>8.1.1</b> DHGLM</a></li>
<li class="chapter" data-level="8.1.2" data-path="8.1-double-hierarchical-models-dhglms.html"><a href="8.1-double-hierarchical-models-dhglms.html#bivariate-dhglm"><i class="fa fa-check"></i><b>8.1.2</b> Bivariate DHGLM</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8.2-zero-inflated-poisson.html"><a href="8.2-zero-inflated-poisson.html"><i class="fa fa-check"></i><b>8.2</b> Zero-inflated Poisson</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-power.html"><a href="9-power.html"><i class="fa fa-check"></i><b>9</b> Conducting a power analysis using squidSim</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The {squidSim} R Package Vignette <br> Version 0.2.2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="va" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Additive genetics effects<a href="4.1-va.html#va" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to simulate breeding values (additive genetic effects), we can provide the <code>simulate_population()</code> function with the relatedness structure in the population. The simplest way to do this is providing a pedigree using the the <code>pedigree</code> argument (a genetic relatedness matrix could also be given to the <code>cov_str</code> argument). The input to this argument needs to be a list, and the name of the pedigree in the list links it with the item in the parameter list.</p>
<p><strong>NOTE</strong> the <code>simulate_population</code> function has very little error checking of pedigree structure at the moment</p>
<p>When simulating breeding values, <strong>all</strong> individuals in pedigree need to be in the data_structure and <em>vice versa</em>. Having unsampled individuals (for example the base population) can be achieved in the sampling stage (not implemented yet).</p>
<p>Lets start by importing a pedigree from the pedtricks package</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="4.1-va.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(squidSim)</span>
<span id="cb170-2"><a href="4.1-va.html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nadiv)</span>
<span id="cb170-3"><a href="4.1-va.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gremlin)</span>
<span id="cb170-4"><a href="4.1-va.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pedtricks)</span>
<span id="cb170-5"><a href="4.1-va.html#cb170-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-6"><a href="4.1-va.html#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(gryphons)</span>
<span id="cb170-7"><a href="4.1-va.html#cb170-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-8"><a href="4.1-va.html#cb170-8" aria-hidden="true" tabindex="-1"></a>ped <span class="ot">&lt;-</span> <span class="fu">fix_ped</span>(gryphons[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])</span>
<span id="cb170-9"><a href="4.1-va.html#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ped)</span></code></pre></div>
<pre><code>##    id  dam sire
## 1 204 &lt;NA&gt; &lt;NA&gt;
## 2 205 &lt;NA&gt; &lt;NA&gt;
## 3 206 &lt;NA&gt; &lt;NA&gt;
## 4 207 &lt;NA&gt; &lt;NA&gt;
## 5 208 &lt;NA&gt; &lt;NA&gt;
## 6 209 &lt;NA&gt; &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="4.1-va.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(ped)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">&quot;animal&quot;</span></span></code></pre></div>
<p>We can use this pedigree as a data_structure</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="4.1-va.html#cb173-1" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb173-2"><a href="4.1-va.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ped[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], </span>
<span id="cb173-3"><a href="4.1-va.html#cb173-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb173-4"><a href="4.1-va.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pedigree =</span> <span class="fu">list</span>(<span class="at">animal=</span>ped[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb173-5"><a href="4.1-va.html#cb173-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb173-6"><a href="4.1-va.html#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span><span class="fu">list</span>(</span>
<span id="cb173-7"><a href="4.1-va.html#cb173-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="fu">list</span>(</span>
<span id="cb173-8"><a href="4.1-va.html#cb173-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.2</span></span>
<span id="cb173-9"><a href="4.1-va.html#cb173-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb173-10"><a href="4.1-va.html#cb173-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb173-11"><a href="4.1-va.html#cb173-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb173-12"><a href="4.1-va.html#cb173-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb173-13"><a href="4.1-va.html#cb173-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb173-14"><a href="4.1-va.html#cb173-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb173-15"><a href="4.1-va.html#cb173-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-16"><a href="4.1-va.html#cb173-16" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb173-17"><a href="4.1-va.html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##            y animal_effect   residual animal  dam sire squid_pop
## 1 -2.3553680    -0.2981992 -2.0571688    204 &lt;NA&gt; &lt;NA&gt;         1
## 2 -0.0831304     0.2218079 -0.3049383    205 &lt;NA&gt; &lt;NA&gt;         1
## 3 -0.1690798    -0.2820988  0.1130190    206 &lt;NA&gt; &lt;NA&gt;         1
## 4  1.6868459     0.6530291  1.0338168    207 &lt;NA&gt; &lt;NA&gt;         1
## 5 -0.4311466    -0.5338738  0.1027271    208 &lt;NA&gt; &lt;NA&gt;         1
## 6 -0.1819541    -0.4747195  0.2927654    209 &lt;NA&gt; &lt;NA&gt;         1</code></pre>
<p>We can use the grelim pacakge to run a REML animal model</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="4.1-va.html#cb175-1" aria-hidden="true" tabindex="-1"></a>Ainv <span class="ot">&lt;-</span> <span class="fu">makeAinv</span>(ped)<span class="sc">$</span>Ainv</span>
<span id="cb175-2"><a href="4.1-va.html#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="4.1-va.html#cb175-3" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gremlin</span>(y<span class="sc">~</span><span class="dv">1</span>, <span class="at">random=</span><span class="sc">~</span> animal,<span class="at">data=</span>data,<span class="at">ginverse=</span><span class="fu">list</span>(<span class="at">animal=</span>Ainv))</span></code></pre></div>
<pre><code>## gremlin started:      18:14:56</code></pre>
<pre><code>## &#39;as(&lt;dsyMatrix&gt;, &quot;dsCMatrix&quot;)&#39; is deprecated.
## Use &#39;as(., &quot;CsparseMatrix&quot;)&#39; instead.
## See help(&quot;Deprecated&quot;) and help(&quot;Matrix-deprecated&quot;).</code></pre>
<pre><code>##   1 of max 20        lL:-7685.481081     took 0.0037 sec.
##   2 of max 20        lL:-1671.313492     took 0.0026 sec.
##   3 of max 20        lL:-1604.018169     took 0.0026 sec.
##   4 of max 20        lL:-1601.696981     took 0.0026 sec.
##   5 of max 20        lL:-1601.692845     took 0.0026 sec.
##   6 of max 20        lL:-1601.692845     took 0.0026 sec.
##   7 of max 20        lL:-1601.692845     took 0.0026 sec.
## 
## ***  REML converged  ***
## 
## gremlin ended:        18:14:56</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="4.1-va.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
##  Linear mixed model fit by REML [&#39; gremlin &#39;]
##  REML log-likelihood: -1601.693 
##   lambda: FALSE 
## 
##  elapsed time for model: 0.0564 
## 
##  Scaled residuals:
##      Min       1Q   Median       3Q      Max 
## -3.05039 -0.54998  0.00371  0.54487  3.14710 
## 
##  (co)variance parameters: ~animal 
##          rcov: ~units 
##          Estimate Std. Error
## G.animal   0.2854    0.02908
## ResVar1    0.4477    0.02554
## 
##  (co)variance parameter sampling correlations:
##          G.animal ResVar1
## G.animal   1.0000 -0.8469
## ResVar1   -0.8469  1.0000
## 
##  Fixed effects: y ~ 1 
##             Estimate Std. Error z value
## (Intercept) -0.02358    0.01526  -1.545</code></pre>
<p>We don’t have to simulate a phenotype for everyone in the pedigree, so can include a subset of IDs in the data strcuture</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="4.1-va.html#cb181-1" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">animal =</span>ped[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(ped),<span class="dv">1000</span>,<span class="at">replace=</span><span class="cn">FALSE</span>),<span class="dv">1</span>])</span>
<span id="cb181-2"><a href="4.1-va.html#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="4.1-va.html#cb181-3" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb181-4"><a href="4.1-va.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds, </span>
<span id="cb181-5"><a href="4.1-va.html#cb181-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb181-6"><a href="4.1-va.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pedigree =</span> <span class="fu">list</span>(<span class="at">animal=</span>ped[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]),</span>
<span id="cb181-7"><a href="4.1-va.html#cb181-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb181-8"><a href="4.1-va.html#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span><span class="fu">list</span>(</span>
<span id="cb181-9"><a href="4.1-va.html#cb181-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="fu">list</span>(</span>
<span id="cb181-10"><a href="4.1-va.html#cb181-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.2</span></span>
<span id="cb181-11"><a href="4.1-va.html#cb181-11" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb181-12"><a href="4.1-va.html#cb181-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb181-13"><a href="4.1-va.html#cb181-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb181-14"><a href="4.1-va.html#cb181-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb181-15"><a href="4.1-va.html#cb181-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb181-16"><a href="4.1-va.html#cb181-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb181-17"><a href="4.1-va.html#cb181-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-18"><a href="4.1-va.html#cb181-18" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb181-19"><a href="4.1-va.html#cb181-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##             y animal_effect    residual animal squid_pop
## 1 -0.46968357   -0.17338301 -0.29630056   3380         1
## 2 -0.08352477   -0.17213302  0.08860825    362         1
## 3 -1.48977040   -0.85945395 -0.63031645   1918         1
## 4 -0.20485162   -0.50879642  0.30394481   2708         1
## 5  0.39879740   -0.08200417  0.48080157   4287         1
## 6 -0.59120933   -0.19983313 -0.39137620   3418         1</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="4.1-va.html#cb183-1" aria-hidden="true" tabindex="-1"></a>Ainv <span class="ot">&lt;-</span> <span class="fu">makeAinv</span>(ped)<span class="sc">$</span>Ainv</span>
<span id="cb183-2"><a href="4.1-va.html#cb183-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-3"><a href="4.1-va.html#cb183-3" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">gremlin</span>(y<span class="sc">~</span><span class="dv">1</span>, <span class="at">random=</span><span class="sc">~</span> animal,<span class="at">data=</span>data,<span class="at">ginverse=</span><span class="fu">list</span>(<span class="at">animal=</span>Ainv))</span></code></pre></div>
<pre><code>## gremlin started:      11:24:44</code></pre>
<pre><code>## &#39;as(&lt;dsyMatrix&gt;, &quot;dsCMatrix&quot;)&#39; is deprecated.
## Use &#39;as(., &quot;CsparseMatrix&quot;)&#39; instead.
## See help(&quot;Deprecated&quot;) and help(&quot;Matrix-deprecated&quot;).</code></pre>
<pre><code>##   1 of max 20        lL:-1551.356413     took 0.0034 sec.
##   2 of max 20        lL:-418.535368      took 0.0023 sec.
##   3 of max 20        lL:-365.175306      took 0.0022 sec.
##   4 of max 20        lL:-359.174824      took 0.0022 sec.
##   5 of max 20        lL:-359.005605      took 0.0022 sec.
##   6 of max 20        lL:-359.005415      took 0.0022 sec.
##   7 of max 20        lL:-359.005415      took 0.0022 sec.
## 
## ***  REML converged  ***
## 
## gremlin ended:        11:24:44</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="4.1-va.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code></pre></div>
<pre><code>## 
##  Linear mixed model fit by REML [&#39; gremlin &#39;]
##  REML log-likelihood: -359.0054 
##   lambda: FALSE 
## 
##  elapsed time for model: 0.0457 
## 
##  Scaled residuals:
##      Min       1Q   Median       3Q      Max 
## -2.43366 -0.45542  0.02354  0.43253  2.86515 
## 
##  (co)variance parameters: ~animal 
##          rcov: ~units 
##          Estimate Std. Error
## G.animal   0.4207    0.09582
## ResVar1    0.3480    0.08755
## 
##  (co)variance parameter sampling correlations:
##          G.animal ResVar1
## G.animal   1.0000 -0.9299
## ResVar1   -0.9299  1.0000
## 
##  Fixed effects: y ~ 1 
##             Estimate Std. Error z value
## (Intercept) -0.04197    0.03176  -1.321</code></pre>
<p>We might want to simulate repeated measurements to allow estimation of permanent environment effects. The simplest way to do this is to create a duplicated column in the data structure of the individual IDs. Permanent environment effects that are not linked to the pedigree can then be simulated.</p>
<!-- 
We might want to simulate repeated measurements to allow estimation of permanent environment effects. This is where being able to have something in the parameter list with a different name to the grouping factor is useful. In this way permanent environmental and additive genetic effects can be simulated in different parts of the parameter list, and linked to the same part of the data_structure.
 -->
<div class="blackbox">
<div class="center">
<p><strong>NOTICE!</strong></p>
</div>
<p>The instructions given for simulating permanent environment effects using squidSim were incorrect in the vignette prior to version 0.2.0 (updated in September 2025).</p>
</div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="4.1-va.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="do">## make data structure with two observations per individual, with ID duplicated in two columns, animal and individual, and link the animal column in the data structure to the pedigree</span></span>
<span id="cb189-2"><a href="4.1-va.html#cb189-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">animal=</span><span class="fu">rep</span>(ped[,<span class="dv">1</span>], <span class="dv">2</span>),<span class="at">individual=</span><span class="fu">rep</span>(ped[,<span class="dv">1</span>], <span class="dv">2</span>))</span>
<span id="cb189-3"><a href="4.1-va.html#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="4.1-va.html#cb189-4" aria-hidden="true" tabindex="-1"></a>squid_data <span class="ot">&lt;-</span> <span class="fu">simulate_population</span>(</span>
<span id="cb189-5"><a href="4.1-va.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data_structure =</span> ds, </span>
<span id="cb189-6"><a href="4.1-va.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pedigree=</span><span class="fu">list</span>(<span class="at">animal=</span>ped),</span>
<span id="cb189-7"><a href="4.1-va.html#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters =</span> <span class="fu">list</span>(</span>
<span id="cb189-8"><a href="4.1-va.html#cb189-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">animal =</span> <span class="fu">list</span>(</span>
<span id="cb189-9"><a href="4.1-va.html#cb189-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.2</span></span>
<span id="cb189-10"><a href="4.1-va.html#cb189-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb189-11"><a href="4.1-va.html#cb189-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">individual =</span> <span class="fu">list</span>(</span>
<span id="cb189-12"><a href="4.1-va.html#cb189-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.3</span></span>
<span id="cb189-13"><a href="4.1-va.html#cb189-13" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb189-14"><a href="4.1-va.html#cb189-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">residual =</span> <span class="fu">list</span>(</span>
<span id="cb189-15"><a href="4.1-va.html#cb189-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">vcov =</span> <span class="fl">0.5</span></span>
<span id="cb189-16"><a href="4.1-va.html#cb189-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb189-17"><a href="4.1-va.html#cb189-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb189-18"><a href="4.1-va.html#cb189-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb189-19"><a href="4.1-va.html#cb189-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-20"><a href="4.1-va.html#cb189-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">get_population_data</span>(squid_data)</span>
<span id="cb189-21"><a href="4.1-va.html#cb189-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<pre><code>##            y animal_effect individual_effect   residual animal individual
## 1 -0.7812849     0.4665620        -1.0389875 -0.2088594    204        204
## 2 -0.3499417    -0.9695562         0.2860528  0.3335617    205        205
## 3 -0.7490084    -0.5394729         0.2739732 -0.4835087    206        206
## 4 -1.1704516    -0.2701808         0.1314451 -1.0317159    207        207
## 5  0.2931743     0.1025247        -0.6129429  0.8035925    208        208
## 6 -0.1245506     0.7061392        -0.1828131 -0.6478767    209        209
##   squid_pop
## 1         1
## 2         1
## 3         1
## 4         1
## 5         1
## 6         1</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="4.1-va.html#cb191-1" aria-hidden="true" tabindex="-1"></a>Ainv <span class="ot">&lt;-</span> <span class="fu">makeAinv</span>(ped)<span class="sc">$</span>Ainv</span>
<span id="cb191-2"><a href="4.1-va.html#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="4.1-va.html#cb191-3" aria-hidden="true" tabindex="-1"></a>mod_pe <span class="ot">&lt;-</span> <span class="fu">gremlin</span>(y<span class="sc">~</span><span class="dv">1</span>, <span class="at">random=</span><span class="sc">~</span> animal <span class="sc">+</span> individual,<span class="at">data=</span>data,<span class="at">ginverse=</span><span class="fu">list</span>(<span class="at">animal=</span>Ainv))</span></code></pre></div>
<pre><code>## gremlin started:      11:24:44 
##   1 of max 20        lL:-12123.358564        took 0.0051 sec.
##   2 of max 20        lL:-4380.793795     took 0.0043 sec.
##   3 of max 20        lL:-4212.077157     took 0.0042 sec.
##   4 of max 20        lL:-4204.524508     took 0.0042 sec.
##   5 of max 20        lL:-4204.496825     took 0.0042 sec.
##   6 of max 20        lL:-4204.496825     took 0.0042 sec.
##   7 of max 20        lL:-4204.496825     took 0.0041 sec.
## 
## ***  REML converged  ***
## 
## gremlin ended:        11:24:44</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="4.1-va.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_pe)</span></code></pre></div>
<pre><code>## 
##  Linear mixed model fit by REML [&#39; gremlin &#39;]
##  REML log-likelihood: -4204.497 
##   lambda: FALSE 
## 
##  elapsed time for model: 0.0596 
## 
##  Scaled residuals:
##     Min      1Q  Median      3Q     Max 
## -3.8558 -0.5524 -0.0036  0.5431  3.0406 
## 
##  (co)variance parameters: ~animal + individual 
##          rcov: ~units 
##              Estimate Std. Error
## G.animal       0.2237   0.029221
## G.individual   0.3022   0.027781
## ResVar1        0.4947   0.009977
## 
##  (co)variance parameter sampling correlations:
##                G.animal G.individual    ResVar1
## G.animal      1.000e+00      -0.8268 -1.794e-15
## G.individual -8.268e-01       1.0000 -1.796e-01
## ResVar1      -1.977e-15      -0.1796  1.000e+00
## 
##  Fixed effects: y ~ 1 
##             Estimate Std. Error z value
## (Intercept) 0.002897    0.01537  0.1885</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-animal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="4.2-multivariate-genetic-effects.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
